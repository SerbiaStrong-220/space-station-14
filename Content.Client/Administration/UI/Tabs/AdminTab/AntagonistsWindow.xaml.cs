using Content.Shared.Administration;
using JetBrains.Annotations;
using Robust.Client.AutoGenerated;
using Robust.Client.Console;
using Robust.Client.UserInterface.Controls;
using Robust.Client.UserInterface.CustomControls;

namespace Content.Client.Administration.UI.Tabs.AdminTab
{
    [GenerateTypedNameReferences]
    [UsedImplicitly]
    public sealed partial class AntagonistsWindow : DefaultWindow
    {
        private PlayerInfo? _selectedAntagonist;

        public event Action<PlayerInfo?>? OnSelectionChanged;

        protected override void EnteredTree()
        {
            AntagonistsList.OnSelectionChanged += OnListOnOnSelectionChanged;
            ListOfTargetsButton.OnPressed += ListOfTargetsButtonOnPressed;
            AddTargetButton.OnPressed += AddTargetButtonOnPressed;
        }

        private void OnListOnOnSelectionChanged(PlayerInfo? obj)
        {
            _selectedAntagonist = obj;
            var disableButtons = _selectedAntagonist == null;
            ListOfTargetsButton.Disabled = disableButtons;
            //AddTargetButton.Disabled = disableButtons;
        }

        private void ListOfTargetsButtonOnPressed(BaseButton.ButtonEventArgs obj)
        {
            if (_selectedAntagonist == null)
                return;

            IoCManager.Resolve<IClientConsoleHost>().ExecuteCommand(
                $"openobjectives {_selectedAntagonist.SessionId}");
        }

        private void AddTargetButtonOnPressed(BaseButton.ButtonEventArgs obj)
        {
            if (_selectedAntagonist == null)
                return;

            //IoCManager.Resolve<IClientConsoleHost>().ExecuteCommand(
            //    $"addtarget {_selectedAntagonist.EntityUid}");
        }
    }
}
